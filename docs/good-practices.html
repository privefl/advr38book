<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Good practices | Advanced R</title>
  <meta name="description" content="This document contains all the materials used in connection to the PhD course about Advanced R held first at the doctoral school of Grenoble, France, and afterwards at the Graduate School of Health, Aarhus University, Denmark." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Good practices | Advanced R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://privefl.github.io/advr38book//images/new_hexsticker.png" />
  <meta property="og:description" content="This document contains all the materials used in connection to the PhD course about Advanced R held first at the doctoral school of Grenoble, France, and afterwards at the Graduate School of Health, Aarhus University, Denmark." />
  <meta name="github-repo" content="privefl/advr38book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Good practices | Advanced R" />
  <meta name="twitter:site" content="@privefl" />
  <meta name="twitter:description" content="This document contains all the materials used in connection to the PhD course about Advanced R held first at the doctoral school of Grenoble, France, and afterwards at the Graduate School of Health, Aarhus University, Denmark." />
  <meta name="twitter:image" content="https://privefl.github.io/advr38book//images/new_hexsticker.png" />

<meta name="author" content="Florian Privé" />


<meta name="date" content="2024-08-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="r-programming.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-100463316-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-100463316-5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Advanced R Course</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-read-this-book"><i class="fa fa-check"></i>How to read this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#content"><i class="fa fa-check"></i>Content</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#useful-resources"><i class="fa fa-check"></i>Useful resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="good-practices.html"><a href="good-practices.html"><i class="fa fa-check"></i><b>2</b> Good practices</a>
<ul>
<li class="chapter" data-level="2.1" data-path="good-practices.html"><a href="good-practices.html#coding-style"><i class="fa fa-check"></i><b>2.1</b> Coding style</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="good-practices.html"><a href="good-practices.html#naming"><i class="fa fa-check"></i><b>2.1.1</b> Naming</a></li>
<li class="chapter" data-level="2.1.2" data-path="good-practices.html"><a href="good-practices.html#spacing"><i class="fa fa-check"></i><b>2.1.2</b> Spacing</a></li>
<li class="chapter" data-level="2.1.3" data-path="good-practices.html"><a href="good-practices.html#indenting"><i class="fa fa-check"></i><b>2.1.3</b> Indenting</a></li>
<li class="chapter" data-level="2.1.4" data-path="good-practices.html"><a href="good-practices.html#long-lines"><i class="fa fa-check"></i><b>2.1.4</b> Long lines</a></li>
<li class="chapter" data-level="2.1.5" data-path="good-practices.html"><a href="good-practices.html#other"><i class="fa fa-check"></i><b>2.1.5</b> Other</a></li>
<li class="chapter" data-level="2.1.6" data-path="good-practices.html"><a href="good-practices.html#code-organization"><i class="fa fa-check"></i><b>2.1.6</b> Code organization</a></li>
<li class="chapter" data-level="2.1.7" data-path="good-practices.html"><a href="good-practices.html#styler"><i class="fa fa-check"></i><b>2.1.7</b> Styler</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="good-practices.html"><a href="good-practices.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="good-practices.html"><a href="good-practices.html#git"><i class="fa fa-check"></i><b>2.3</b> Version control (Git)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="good-practices.html"><a href="good-practices.html#why-use-git"><i class="fa fa-check"></i><b>2.3.1</b> Why use Git?</a></li>
<li class="chapter" data-level="2.3.2" data-path="good-practices.html"><a href="good-practices.html#how-to-use-git"><i class="fa fa-check"></i><b>2.3.2</b> How to use Git</a></li>
<li class="chapter" data-level="" data-path="good-practices.html"><a href="good-practices.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="good-practices.html"><a href="good-practices.html#when-things-go-wrong"><i class="fa fa-check"></i><b>2.4</b> When things go wrong…</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="good-practices.html"><a href="good-practices.html#first-locate-the-error"><i class="fa fa-check"></i><b>2.4.1</b> First: locate the error</a></li>
<li class="chapter" data-level="2.4.2" data-path="good-practices.html"><a href="good-practices.html#second-fix-the-error"><i class="fa fa-check"></i><b>2.4.2</b> Second: fix the error</a></li>
<li class="chapter" data-level="2.4.3" data-path="good-practices.html"><a href="good-practices.html#external-help"><i class="fa fa-check"></i><b>2.4.3</b> External help</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="good-practices.html"><a href="good-practices.html#summary"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="good-practices.html"><a href="good-practices.html#useful-resources-1"><i class="fa fa-check"></i>Useful resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-programming.html"><a href="r-programming.html"><i class="fa fa-check"></i><b>3</b> R programming</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-programming.html"><a href="r-programming.html#common-mistakes-to-avoid"><i class="fa fa-check"></i><b>3.1</b> Common mistakes to avoid</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="r-programming.html"><a href="r-programming.html#the-floating-point-error"><i class="fa fa-check"></i><b>3.1.1</b> The floating-point error</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-programming.html"><a href="r-programming.html#the-...-argument"><i class="fa fa-check"></i><b>3.1.2</b> The <code>...</code> argument</a></li>
<li class="chapter" data-level="3.1.3" data-path="r-programming.html"><a href="r-programming.html#others"><i class="fa fa-check"></i><b>3.1.3</b> Others</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-programming.html"><a href="r-programming.html#useful-r-functions"><i class="fa fa-check"></i><b>3.2</b> Useful <code>R</code> functions</a>
<ul>
<li class="chapter" data-level="" data-path="r-programming.html"><a href="r-programming.html#general"><i class="fa fa-check"></i>General</a></li>
<li class="chapter" data-level="" data-path="r-programming.html"><a href="r-programming.html#sequence-and-vector-operations"><i class="fa fa-check"></i>Sequence and vector operations</a></li>
<li class="chapter" data-level="" data-path="r-programming.html"><a href="r-programming.html#character-operations"><i class="fa fa-check"></i>Character operations</a></li>
<li class="chapter" data-level="" data-path="r-programming.html"><a href="r-programming.html#logical-operators"><i class="fa fa-check"></i>Logical operators</a></li>
<li class="chapter" data-level="" data-path="r-programming.html"><a href="r-programming.html#useful-non-base-r-functions"><i class="fa fa-check"></i>Useful non-base R functions</a></li>
<li class="chapter" data-level="" data-path="r-programming.html"><a href="r-programming.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="r-programming.html"><a href="r-programming.html#data-structures-in-r"><i class="fa fa-check"></i><b>3.3</b> Data structures in <code>R</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="r-programming.html"><a href="r-programming.html#types"><i class="fa fa-check"></i><b>3.3.1</b> Types</a></li>
<li class="chapter" data-level="3.3.2" data-path="r-programming.html"><a href="r-programming.html#objects-and-attributes"><i class="fa fa-check"></i><b>3.3.2</b> Objects and attributes</a></li>
<li class="chapter" data-level="3.3.3" data-path="r-programming.html"><a href="r-programming.html#accessors"><i class="fa fa-check"></i><b>3.3.3</b> Accessors</a></li>
<li class="chapter" data-level="" data-path="r-programming.html"><a href="r-programming.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-programming.html"><a href="r-programming.html#environments-and-scoping"><i class="fa fa-check"></i><b>3.4</b> Environments and scoping</a></li>
<li class="chapter" data-level="3.5" data-path="r-programming.html"><a href="r-programming.html#summary-1"><i class="fa fa-check"></i><b>3.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="r-programming.html"><a href="r-programming.html#useful-resources-2"><i class="fa fa-check"></i>Useful resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>4</b> R Markdown</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rmarkdown.html"><a href="rmarkdown.html#r-markdown-basics"><i class="fa fa-check"></i><b>4.1</b> R Markdown basics</a>
<ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#the-yaml-header"><i class="fa fa-check"></i>The YAML header</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#r-code-chunks"><i class="fa fa-check"></i><code>R</code> code chunks</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#plain-text-with-simple-text-formatting"><i class="fa fa-check"></i>Plain text with simple text formatting</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="rmarkdown.html"><a href="rmarkdown.html#producing-a-complete-report"><i class="fa fa-check"></i><b>4.2</b> Producing a complete report</a>
<ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#exercise-2"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rmarkdown.html"><a href="rmarkdown.html#summary-2"><i class="fa fa-check"></i><b>4.3</b> Summary</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#useful-resources-3"><i class="fa fa-check"></i>Useful resources</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>5</b> Data analysis with the tidyverse</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tidyverse.html"><a href="tidyverse.html#program"><i class="fa fa-check"></i><b>5.1</b> Program</a></li>
<li class="chapter" data-level="5.2" data-path="tidyverse.html"><a href="tidyverse.html#other-chapters-from-this-book"><i class="fa fa-check"></i><b>5.2</b> Other chapters from this book</a></li>
<li class="chapter" data-level="5.3" data-path="tidyverse.html"><a href="tidyverse.html#other-resources"><i class="fa fa-check"></i><b>5.3</b> Other resources</a></li>
<li class="chapter" data-level="5.4" data-path="tidyverse.html"><a href="tidyverse.html#other-tidy-packages"><i class="fa fa-check"></i><b>5.4</b> Other “tidy” packages</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>6</b> Performance</a>
<ul>
<li class="chapter" data-level="6.1" data-path="performance.html"><a href="performance.html#rs-memory-management"><i class="fa fa-check"></i><b>6.1</b> R’s memory management</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="performance.html"><a href="performance.html#understanding-binding-basics"><i class="fa fa-check"></i><b>6.1.1</b> Understanding binding basics</a></li>
<li class="chapter" data-level="6.1.2" data-path="performance.html"><a href="performance.html#copy-on-modify"><i class="fa fa-check"></i><b>6.1.2</b> Copy-on-modify</a></li>
<li class="chapter" data-level="6.1.3" data-path="performance.html"><a href="performance.html#copy-on-modify-what-about-inside-functions"><i class="fa fa-check"></i><b>6.1.3</b> Copy-on-modify: what about inside functions?</a></li>
<li class="chapter" data-level="6.1.4" data-path="performance.html"><a href="performance.html#lists"><i class="fa fa-check"></i><b>6.1.4</b> Lists</a></li>
<li class="chapter" data-level="6.1.5" data-path="performance.html"><a href="performance.html#copy-on-modify-for-lists"><i class="fa fa-check"></i><b>6.1.5</b> Copy-on-modify for lists?</a></li>
<li class="chapter" data-level="6.1.6" data-path="performance.html"><a href="performance.html#data-frames"><i class="fa fa-check"></i><b>6.1.6</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="performance.html"><a href="performance.html#early-advice"><i class="fa fa-check"></i><b>6.2</b> Early advice</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="performance.html"><a href="performance.html#never-grow-a-vector"><i class="fa fa-check"></i><b>6.2.1</b> NEVER GROW A VECTOR</a></li>
<li class="chapter" data-level="6.2.2" data-path="performance.html"><a href="performance.html#use-the-right-function"><i class="fa fa-check"></i><b>6.2.2</b> Use the right function</a></li>
<li class="chapter" data-level="6.2.3" data-path="performance.html"><a href="performance.html#do-not-try-to-optimize-everything"><i class="fa fa-check"></i><b>6.2.3</b> Do not try to optimize everything</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="performance.html"><a href="performance.html#vectorization"><i class="fa fa-check"></i><b>6.3</b> Vectorization</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="performance.html"><a href="performance.html#exercise-3"><i class="fa fa-check"></i><b>6.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="performance.html"><a href="performance.html#Rcpp"><i class="fa fa-check"></i><b>6.4</b> Rcpp</a></li>
<li class="chapter" data-level="6.5" data-path="performance.html"><a href="performance.html#linear-algebra"><i class="fa fa-check"></i><b>6.5</b> Linear algebra</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="performance.html"><a href="performance.html#exercises-3"><i class="fa fa-check"></i><b>6.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="performance.html"><a href="performance.html#algorithms-data-structures"><i class="fa fa-check"></i><b>6.6</b> Algorithms &amp; data structures</a></li>
<li class="chapter" data-level="6.7" data-path="performance.html"><a href="performance.html#exos"><i class="fa fa-check"></i><b>6.7</b> Exercises</a></li>
<li class="chapter" data-level="6.8" data-path="performance.html"><a href="performance.html#parallel-computing"><i class="fa fa-check"></i><b>6.8</b> Parallel computing</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>7</b> Packages</a>
<ul>
<li class="chapter" data-level="7.1" data-path="packages.html"><a href="packages.html#resources"><i class="fa fa-check"></i><b>7.1</b> Resources</a></li>
<li class="chapter" data-level="7.2" data-path="packages.html"><a href="packages.html#project-exercise"><i class="fa fa-check"></i><b>7.2</b> Project exercise</a></li>
<li class="chapter" data-level="7.3" data-path="packages.html"><a href="packages.html#pkg-start"><i class="fa fa-check"></i><b>7.3</b> Quick start</a></li>
<li class="chapter" data-level="7.4" data-path="packages.html"><a href="packages.html#pkg-basics"><i class="fa fa-check"></i><b>7.4</b> Basic stuff</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="packages.html"><a href="packages.html#description-file"><i class="fa fa-check"></i><b>7.4.1</b> <em>DESCRIPTION</em> file</a></li>
<li class="chapter" data-level="7.4.2" data-path="packages.html"><a href="packages.html#r-code"><i class="fa fa-check"></i><b>7.4.2</b> R code</a></li>
<li class="chapter" data-level="7.4.3" data-path="packages.html"><a href="packages.html#documentation"><i class="fa fa-check"></i><b>7.4.3</b> Documentation</a></li>
<li class="chapter" data-level="7.4.4" data-path="packages.html"><a href="packages.html#namespace-file"><i class="fa fa-check"></i><b>7.4.4</b> <em>NAMESPACE</em> file</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="packages.html"><a href="packages.html#good-practices-1"><i class="fa fa-check"></i><b>7.5</b> Good practices</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="packages.html"><a href="packages.html#pkg-tests"><i class="fa fa-check"></i><b>7.5.1</b> Testing</a></li>
<li class="chapter" data-level="7.5.2" data-path="packages.html"><a href="packages.html#pkg-ci"><i class="fa fa-check"></i><b>7.5.2</b> Continuous checking</a></li>
<li class="chapter" data-level="7.5.3" data-path="packages.html"><a href="packages.html#pkgdown"><i class="fa fa-check"></i><b>7.5.3</b> Pkgdown</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="packages.html"><a href="packages.html#more"><i class="fa fa-check"></i><b>7.6</b> More</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="packages.html"><a href="packages.html#rcpp"><i class="fa fa-check"></i><b>7.6.1</b> Rcpp</a></li>
<li class="chapter" data-level="7.6.2" data-path="packages.html"><a href="packages.html#ignore-files"><i class="fa fa-check"></i><b>7.6.2</b> Ignore files</a></li>
<li class="chapter" data-level="7.6.3" data-path="packages.html"><a href="packages.html#the-inst-directory"><i class="fa fa-check"></i><b>7.6.3</b> The <code>inst/</code> directory</a></li>
<li class="chapter" data-level="7.6.4" data-path="packages.html"><a href="packages.html#pkg-data"><i class="fa fa-check"></i><b>7.6.4</b> External data</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="packages.html"><a href="packages.html#release-on-cran"><i class="fa fa-check"></i><b>7.7</b> Release on CRAN</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>8</b> Shiny</a>
<ul>
<li class="chapter" data-level="8.1" data-path="shiny.html"><a href="shiny.html#example"><i class="fa fa-check"></i><b>8.1</b> Example</a></li>
<li class="chapter" data-level="8.2" data-path="shiny.html"><a href="shiny.html#datacamp-course"><i class="fa fa-check"></i><b>8.2</b> DataCamp course</a></li>
<li class="chapter" data-level="8.3" data-path="shiny.html"><a href="shiny.html#other-resources-1"><i class="fa fa-check"></i><b>8.3</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="project.html"><a href="project.html"><i class="fa fa-check"></i><b>9</b> Project</a>
<ul>
<li class="chapter" data-level="9.1" data-path="project.html"><a href="project.html#what-is-tidy-tuesday"><i class="fa fa-check"></i><b>9.1</b> What is Tidy Tuesday?</a></li>
<li class="chapter" data-level="9.2" data-path="project.html"><a href="project.html#tidy-thursday"><i class="fa fa-check"></i><b>9.2</b> Tidy Thursday</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="project.html"><a href="project.html#choose-a-dataset"><i class="fa fa-check"></i><b>9.2.1</b> Choose a dataset</a></li>
<li class="chapter" data-level="9.2.2" data-path="project.html"><a href="project.html#visualize-the-data"><i class="fa fa-check"></i><b>9.2.2</b> Visualize the data</a></li>
<li class="chapter" data-level="9.2.3" data-path="project.html"><a href="project.html#compilation-of-tweets"><i class="fa fa-check"></i><b>9.2.3</b> Compilation of tweets</a></li>
<li class="chapter" data-level="9.2.4" data-path="project.html"><a href="project.html#example-1"><i class="fa fa-check"></i><b>9.2.4</b> Example</a></li>
<li class="chapter" data-level="9.2.5" data-path="project.html"><a href="project.html#presentation"><i class="fa fa-check"></i><b>9.2.5</b> Presentation</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="good-practices" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Good practices<a href="good-practices.html#good-practices" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the following, we will consider some good practices for writing <code>R</code> code. But before we dive into that topic, let us explain why code needs to be clean and efficient. First, if you are working in a team, writing efficient and clean code makes it a lot easier for you colleagues to understand, debug and improve it. If you want your colleagues or collaborators to reuse your code, it should be readable and easy to follow. Second, you can spare your future self a lot of frustration by writing clean code from the beginning. By doing that, you won’t have to ask yourself</p>
<p><strong>What the hell am I doing in this function?</strong></p>
<p><img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExYnoxczBqbzVtZmtkOWdwZ2YzcXNoaXRwMGd0N21jNTMwcnlwaXE0ZCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Ur8XCl98PfFqEmyNIE/giphy.gif" /></p>
<div id="coding-style" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Coding style<a href="good-practices.html#coding-style" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Good coding style is like correct punctuation: you can manage without it, butitsuremakesthingseasiertoread.</p>
<footer>
— Hadley Wickham
</footer>
</blockquote>
<p>Please make your code readable by following the available style guides. We recommend you take a look at the <a href="http://style.tidyverse.org/">tidyverse style guide</a>. In the following, we provide some examples from this guide.</p>
<div id="naming" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Naming<a href="good-practices.html#naming" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Be smart with your naming. You won’t believe how often we have seen <code>df &lt;- as.matrix(mtcars)</code> on Stack Overflow. Use meaningful and concise names for your files, data sets, and functions; you will save yourself a lot of time.
For example, consider the following piece of code</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="good-practices.html#cb1-1" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> tidytuesdayR<span class="sc">::</span><span class="fu">tt_load</span>(<span class="st">&quot;2020-01-14&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb1-2"><a href="good-practices.html#cb1-2" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> dat1[dat1<span class="sc">$</span>category <span class="sc">==</span> <span class="st">&quot;animal&quot;</span>,]</span>
<span id="cb1-3"><a href="good-practices.html#cb1-3" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> dat1[dat1<span class="sc">$</span>strength <span class="sc">==</span> <span class="dv">7</span>,]</span>
<span id="cb1-4"><a href="good-practices.html#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="good-practices.html#cb1-5" tabindex="-1"></a>fct1 <span class="ot">&lt;-</span> <span class="cf">function</span>(tbl, <span class="at">n =</span> <span class="dv">5</span>) {</span>
<span id="cb1-6"><a href="good-practices.html#cb1-6" tabindex="-1"></a>  </span>
<span id="cb1-7"><a href="good-practices.html#cb1-7" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> tbl[<span class="fu">complete.cases</span>(tbl<span class="sc">$</span>rank),]</span>
<span id="cb1-8"><a href="good-practices.html#cb1-8" tabindex="-1"></a>  tbl[tbl<span class="sc">$</span>rank <span class="sc">&lt;=</span> n, <span class="dv">2</span>]</span>
<span id="cb1-9"><a href="good-practices.html#cb1-9" tabindex="-1"></a>}</span></code></pre></div>
<p>Looking only at this code, do you have any idea what data is stored in <code>dat1</code>, <code>dat2</code> and <code>dat3</code>? Not really, right? Now imagine, you have 500 lines of code analyzing and visualizing the three different data sets using numerous functions. You would probably get confused about the different data sets and functions quite quick. Now consider the following lines of code</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="good-practices.html#cb2-1" tabindex="-1"></a>passwords <span class="ot">&lt;-</span> tidytuesdayR<span class="sc">::</span><span class="fu">tt_load</span>(<span class="st">&quot;2020-01-14&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb2-2"><a href="good-practices.html#cb2-2" tabindex="-1"></a>password_category <span class="ot">&lt;-</span> passwords[passwords<span class="sc">$</span>category <span class="sc">==</span> <span class="st">&quot;animal&quot;</span>, ]</span>
<span id="cb2-3"><a href="good-practices.html#cb2-3" tabindex="-1"></a>password_strength <span class="ot">&lt;-</span> passwords[passwords<span class="sc">$</span>strength <span class="sc">==</span> <span class="dv">7</span>, ]</span>
<span id="cb2-4"><a href="good-practices.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="good-practices.html#cb2-5" tabindex="-1"></a>get_popular_passwords <span class="ot">&lt;-</span> <span class="cf">function</span>(tbl, <span class="at">n =</span> <span class="dv">5</span>) {</span>
<span id="cb2-6"><a href="good-practices.html#cb2-6" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> tbl[<span class="fu">complete.cases</span>(tbl<span class="sc">$</span>rank), ]</span>
<span id="cb2-7"><a href="good-practices.html#cb2-7" tabindex="-1"></a>  tbl[tbl<span class="sc">$</span>rank <span class="sc">&lt;=</span> n, <span class="dv">2</span>]</span>
<span id="cb2-8"><a href="good-practices.html#cb2-8" tabindex="-1"></a>}</span></code></pre></div>
<p>This code is identical to the previous code; except for the names. But it is much easier to read and understand. Let us improve the code even more by adding comments.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="good-practices.html#cb3-1" tabindex="-1"></a><span class="co"># Loading the passwords data</span></span>
<span id="cb3-2"><a href="good-practices.html#cb3-2" tabindex="-1"></a>passwords <span class="ot">&lt;-</span> tidytuesdayR<span class="sc">::</span><span class="fu">tt_load</span>(<span class="st">&quot;2020-01-14&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb3-3"><a href="good-practices.html#cb3-3" tabindex="-1"></a><span class="co"># Extracting passwords within the category &quot;animal&quot;</span></span>
<span id="cb3-4"><a href="good-practices.html#cb3-4" tabindex="-1"></a>password_category <span class="ot">&lt;-</span> passwords[passwords<span class="sc">$</span>category <span class="sc">==</span> <span class="st">&quot;animal&quot;</span>, ]</span>
<span id="cb3-5"><a href="good-practices.html#cb3-5" tabindex="-1"></a><span class="co"># Extracting passwords with a quality of 7</span></span>
<span id="cb3-6"><a href="good-practices.html#cb3-6" tabindex="-1"></a>password_strength <span class="ot">&lt;-</span> passwords[passwords<span class="sc">$</span>strength <span class="sc">==</span> <span class="dv">7</span>, ]</span>
<span id="cb3-7"><a href="good-practices.html#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="good-practices.html#cb3-8" tabindex="-1"></a><span class="co"># Function: extracts the n most popular passwords</span></span>
<span id="cb3-9"><a href="good-practices.html#cb3-9" tabindex="-1"></a>get_popular_passwords <span class="ot">&lt;-</span> <span class="cf">function</span>(tbl, <span class="at">n =</span> <span class="dv">5</span>) {</span>
<span id="cb3-10"><a href="good-practices.html#cb3-10" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> tbl[<span class="fu">complete.cases</span>(tbl<span class="sc">$</span>rank), ]</span>
<span id="cb3-11"><a href="good-practices.html#cb3-11" tabindex="-1"></a>  tbl[tbl<span class="sc">$</span>rank <span class="sc">&lt;=</span> n, <span class="dv">2</span>]</span>
<span id="cb3-12"><a href="good-practices.html#cb3-12" tabindex="-1"></a>}</span></code></pre></div>
<p>When commenting code, you should focus on explaining the “why” instead of the “what” or “how”. Comments should be in sentence case, and only end with a full stop if they contain at least two sentences.</p>
<p>Suggestions for naming:</p>
<ul>
<li>For files names, use underscore separated strings. All words should be lower case, e.g. <code>fit_models.R</code> or <code>utility_functions.R</code> (with consideration for operating systems with a case-sensitive file systems). Never have file names that only differ in their capitalization! Avoid using special characters in file names.</li>
<li>For function names, use only lowercase letters and numbers separated by an underscore (<code>_</code>), e.g. <code>compute_mean</code>. Avoid using dots in function names, as they should be reserved exclusively for the S3 object system. Generally, function names should be verbs.</li>
<li>For variable names, use only lowercase letters and numbers separated by an underscore (<code>_</code>), e.g. <code>day_1</code>.
Avoid re-using names of common functions and variables (such as <code>mean</code>, <code>c</code> or <code>T</code>), as this may cause confusion for the readers. Generally, variable names should be nouns.</li>
</ul>
</div>
<div id="spacing" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Spacing<a href="good-practices.html#spacing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Place a space before and after <code>=</code> when naming arguments in function calls.
Most infix operators (<code>==</code>, <code>+</code>, <code>-</code>, <code>&lt;-</code>, etc.) are also surrounded by spaces, except</p>
<ul>
<li>those with high precedence (<code>^</code>, <code>:</code>, <code>::</code>, and <code>:::</code>, <code>$</code>, <code>[</code>, <code>[[</code>),</li>
<li><code>!!</code> (bang-bang) and <code>!!!</code> (bang-bang-bang) when used in tidy evaluation,</li>
<li>the help operator <code>?</code>.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="good-practices.html#cb4-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb4-2"><a href="good-practices.html#cb4-2" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="fu">mean</span>((feet <span class="sc">/</span> <span class="dv">12</span>) <span class="sc">+</span> inches, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-3"><a href="good-practices.html#cb4-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb4-4"><a href="good-practices.html#cb4-4" tabindex="-1"></a>base<span class="sc">::</span>sum</span>
<span id="cb4-5"><a href="good-practices.html#cb4-5" tabindex="-1"></a>?mean</span>
<span id="cb4-6"><a href="good-practices.html#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="good-practices.html#cb4-7" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb4-8"><a href="good-practices.html#cb4-8" tabindex="-1"></a>average<span class="ot">&lt;-</span><span class="fu">mean</span>(feet<span class="sc">/</span><span class="dv">12</span><span class="sc">+</span>inches,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-9"><a href="good-practices.html#cb4-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">:</span> <span class="dv">10</span></span>
<span id="cb4-10"><a href="good-practices.html#cb4-10" tabindex="-1"></a>base <span class="sc">::</span> sum</span>
<span id="cb4-11"><a href="good-practices.html#cb4-11" tabindex="-1"></a>? mean</span></code></pre></div>
<p>Always put a space after a comma, and never before (just like in regular English).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="good-practices.html#cb5-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb5-2"><a href="good-practices.html#cb5-2" tabindex="-1"></a>x[, <span class="dv">1</span>]</span>
<span id="cb5-3"><a href="good-practices.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="good-practices.html#cb5-4" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb5-5"><a href="good-practices.html#cb5-5" tabindex="-1"></a>x[,<span class="dv">1</span>]</span>
<span id="cb5-6"><a href="good-practices.html#cb5-6" tabindex="-1"></a>x[ ,<span class="dv">1</span>]</span>
<span id="cb5-7"><a href="good-practices.html#cb5-7" tabindex="-1"></a>x[ , <span class="dv">1</span>]</span></code></pre></div>
<p>For parenthesis, there are three different rules. When parentheses are used in connection to regular function calls, they are not surround by space:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="good-practices.html#cb6-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb6-2"><a href="good-practices.html#cb6-2" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-3"><a href="good-practices.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="good-practices.html#cb6-4" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb6-5"><a href="good-practices.html#cb6-5" tabindex="-1"></a><span class="fu">mean</span> (x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-6"><a href="good-practices.html#cb6-6" tabindex="-1"></a><span class="fu">mean</span>( x, <span class="at">na.rm =</span> <span class="cn">TRUE</span> )</span></code></pre></div>
<p>However, when the parentheses are used with <code>if</code>, <code>for</code>, or <code>while</code>, they are surrounded by space:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="good-practices.html#cb7-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb7-2"><a href="good-practices.html#cb7-2" tabindex="-1"></a><span class="cf">if</span> (debug) {</span>
<span id="cb7-3"><a href="good-practices.html#cb7-3" tabindex="-1"></a>  <span class="fu">show</span>(x)</span>
<span id="cb7-4"><a href="good-practices.html#cb7-4" tabindex="-1"></a>}</span>
<span id="cb7-5"><a href="good-practices.html#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="good-practices.html#cb7-6" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb7-7"><a href="good-practices.html#cb7-7" tabindex="-1"></a><span class="cf">if</span>(debug){</span>
<span id="cb7-8"><a href="good-practices.html#cb7-8" tabindex="-1"></a>  <span class="fu">show</span>(x)</span>
<span id="cb7-9"><a href="good-practices.html#cb7-9" tabindex="-1"></a>}</span></code></pre></div>
<p>When the parentheses are used for function arguments, you put a space after the closing parenthesis <code>)</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="good-practices.html#cb8-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb8-2"><a href="good-practices.html#cb8-2" tabindex="-1"></a><span class="cf">function</span>(x) {}</span>
<span id="cb8-3"><a href="good-practices.html#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="good-practices.html#cb8-4" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb8-5"><a href="good-practices.html#cb8-5" tabindex="-1"></a><span class="cf">function</span> (x) {}</span>
<span id="cb8-6"><a href="good-practices.html#cb8-6" tabindex="-1"></a><span class="cf">function</span>(x){}</span></code></pre></div>
<p>Finally, the pipe <code>%&gt;%</code> should always have a space before it, and it is usually followed by a new line.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="good-practices.html#cb9-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb9-2"><a href="good-practices.html#cb9-2" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="good-practices.html#cb9-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="good-practices.html#cb9-4" tabindex="-1"></a>  <span class="fu">summarize_if</span>(is.numeric, mean) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="good-practices.html#cb9-5" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="good-practices.html#cb9-6" tabindex="-1"></a>  <span class="fu">gather</span>(measure, value, <span class="sc">-</span>Species) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="good-practices.html#cb9-7" tabindex="-1"></a>  <span class="fu">arrange</span>(value)</span>
<span id="cb9-8"><a href="good-practices.html#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="good-practices.html#cb9-9" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb9-10"><a href="good-practices.html#cb9-10" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> <span class="fu">summarize_all</span>(mean) <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="good-practices.html#cb9-11" tabindex="-1"></a>ungroup <span class="sc">%&gt;%</span> <span class="fu">gather</span>(measure, value, <span class="sc">-</span>Species) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="good-practices.html#cb9-12" tabindex="-1"></a><span class="fu">arrange</span>(value)</span></code></pre></div>
<p>We will return to the pipe operator in Chapter <a href="tidyverse.html#tidyverse">5</a>. The same styling suggestions also hold for the operator that separates <code>ggplot2</code> layers, <code>+</code>. You will meet this operator again in Chapter <a href="tidyverse.html#tidyverse">5</a>.</p>
</div>
<div id="indenting" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Indenting<a href="good-practices.html#indenting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Curly braces, <code>{}</code>, define the most important hierarchy of <code>R</code> code. To make this hierarchy easy to see, always indent the code inside <code>{}</code> by two spaces. This should be automatic in RStudio.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="good-practices.html#cb10-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb10-2"><a href="good-practices.html#cb10-2" tabindex="-1"></a><span class="cf">if</span> (y <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> debug) {</span>
<span id="cb10-3"><a href="good-practices.html#cb10-3" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;y is negative&quot;</span>)</span>
<span id="cb10-4"><a href="good-practices.html#cb10-4" tabindex="-1"></a>}</span>
<span id="cb10-5"><a href="good-practices.html#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="good-practices.html#cb10-6" tabindex="-1"></a><span class="cf">if</span> (y <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb10-7"><a href="good-practices.html#cb10-7" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb10-8"><a href="good-practices.html#cb10-8" tabindex="-1"></a>    <span class="fu">log</span>(x)</span>
<span id="cb10-9"><a href="good-practices.html#cb10-9" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-10"><a href="good-practices.html#cb10-10" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&quot;x is negative or zero&quot;</span>)</span>
<span id="cb10-11"><a href="good-practices.html#cb10-11" tabindex="-1"></a>  }</span>
<span id="cb10-12"><a href="good-practices.html#cb10-12" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb10-13"><a href="good-practices.html#cb10-13" tabindex="-1"></a>  y <span class="sc">^</span> x</span>
<span id="cb10-14"><a href="good-practices.html#cb10-14" tabindex="-1"></a>}</span>
<span id="cb10-15"><a href="good-practices.html#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="good-practices.html#cb10-16" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb10-17"><a href="good-practices.html#cb10-17" tabindex="-1"></a><span class="cf">if</span> (y <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> debug)</span>
<span id="cb10-18"><a href="good-practices.html#cb10-18" tabindex="-1"></a><span class="fu">message</span>(<span class="st">&quot;Y is negative&quot;</span>)</span>
<span id="cb10-19"><a href="good-practices.html#cb10-19" tabindex="-1"></a></span>
<span id="cb10-20"><a href="good-practices.html#cb10-20" tabindex="-1"></a><span class="cf">if</span> (y <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb10-21"><a href="good-practices.html#cb10-21" tabindex="-1"></a>{</span>
<span id="cb10-22"><a href="good-practices.html#cb10-22" tabindex="-1"></a>    <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb10-23"><a href="good-practices.html#cb10-23" tabindex="-1"></a>      <span class="fu">log</span>(x)</span>
<span id="cb10-24"><a href="good-practices.html#cb10-24" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb10-25"><a href="good-practices.html#cb10-25" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&quot;x is negative or zero&quot;</span>)</span>
<span id="cb10-26"><a href="good-practices.html#cb10-26" tabindex="-1"></a>    }</span>
<span id="cb10-27"><a href="good-practices.html#cb10-27" tabindex="-1"></a>} <span class="cf">else</span> { y <span class="sc">^</span> x }</span></code></pre></div>
</div>
<div id="long-lines" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Long lines<a href="good-practices.html#long-lines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Strive to limit your code to 80 characters per line. This fits comfortably on your screen with a reasonably sized font. If you find yourself running out of room, this is a good indication that you should encapsulate some of the work in a separate function. To change the margin in RStudio go to Tools -&gt; Global Options -&gt; Code -&gt; Display, and set <code>Margin column:</code> to 80.</p>
<center>
<video width="560" height="315" autoplay loop muted preload="true" poster="images/margin80.png">
<source src="Clips/Change_margin_column.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>
</center>
</div>
<div id="other" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Other<a href="good-practices.html#other" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Use <code>&lt;-</code>, not <code>=</code>, for assignment. Keep <code>=</code> for parameters.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="good-practices.html#cb11-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb11-2"><a href="good-practices.html#cb11-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb11-3"><a href="good-practices.html#cb11-3" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb11-4"><a href="good-practices.html#cb11-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e6</span>)</span>
<span id="cb11-5"><a href="good-practices.html#cb11-5" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="good-practices.html#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="good-practices.html#cb11-7" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb11-8"><a href="good-practices.html#cb11-8" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb11-9"><a href="good-practices.html#cb11-9" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb11-10"><a href="good-practices.html#cb11-10" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="fl">1e6</span>)</span>
<span id="cb11-11"><a href="good-practices.html#cb11-11" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li><p>Don’t end a line of code with <code>;</code>, and avoid multiple commands
on the same line.</p></li>
<li><p>Only use <code>return()</code> for early returns. Otherwise rely on <code>R</code> to return the result of the last evaluated expression. Moreover, return statements should always be on their own line.</p></li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="good-practices.html#cb12-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb12-2"><a href="good-practices.html#cb12-2" tabindex="-1"></a>add_two <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb12-3"><a href="good-practices.html#cb12-3" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb12-4"><a href="good-practices.html#cb12-4" tabindex="-1"></a>}</span>
<span id="cb12-5"><a href="good-practices.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="good-practices.html#cb12-6" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb12-7"><a href="good-practices.html#cb12-7" tabindex="-1"></a>add_two <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb12-8"><a href="good-practices.html#cb12-8" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">+</span> y)</span>
<span id="cb12-9"><a href="good-practices.html#cb12-9" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li>Use <code>"</code>, not <code>'</code>, for quoting text. The only exception is when the text already contains double quotes and no single quotes.</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="good-practices.html#cb13-1" tabindex="-1"></a><span class="co"># Good</span></span>
<span id="cb13-2"><a href="good-practices.html#cb13-2" tabindex="-1"></a><span class="st">&quot;Text&quot;</span></span>
<span id="cb13-3"><a href="good-practices.html#cb13-3" tabindex="-1"></a><span class="st">&#39;Text with &quot;quotes&quot;&#39;</span></span>
<span id="cb13-4"><a href="good-practices.html#cb13-4" tabindex="-1"></a><span class="st">&#39;&lt;a href=&quot;http://style.tidyverse.org&quot;&gt;A link&lt;/a&gt;&#39;</span></span>
<span id="cb13-5"><a href="good-practices.html#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="good-practices.html#cb13-6" tabindex="-1"></a><span class="co"># Unfortunate</span></span>
<span id="cb13-7"><a href="good-practices.html#cb13-7" tabindex="-1"></a><span class="st">&#39;Text&#39;</span></span>
<span id="cb13-8"><a href="good-practices.html#cb13-8" tabindex="-1"></a><span class="st">&#39;Text with &quot;double&quot; and </span><span class="sc">\&#39;</span><span class="st">single</span><span class="sc">\&#39;</span><span class="st"> quotes&#39;</span></span></code></pre></div>
<ul>
<li>Use <code>TRUE</code> and <code>FALSE</code> instead of <code>T</code> and <code>F</code>.</li>
</ul>
</div>
<div id="code-organization" class="section level3 hasAnchor" number="2.1.6">
<h3><span class="header-section-number">2.1.6</span> Code organization<a href="good-practices.html#code-organization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The way the code is organized within a single file significantly impacts the readability.
We suggest to start each file with a comment holding a description of the file, who wrote it,
and when it was last updated. You may want to set a default template that is used each time you open a new <code>.R</code> script. To do this, you have to create a <code>templates</code> folder in <code>AppData/Roaming/RStudio/</code> and include a <code>default.R</code> file with the desired template.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="good-practices.html#cb14-1" tabindex="-1"></a><span class="co"># Create a template folder</span></span>
<span id="cb14-2"><a href="good-practices.html#cb14-2" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">dir_create</span>(<span class="at">path =</span> <span class="st">&quot;~/AppData/Roaming/RStudio/templates&quot;</span>)</span>
<span id="cb14-3"><a href="good-practices.html#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="good-practices.html#cb14-4" tabindex="-1"></a><span class="co"># Create the file</span></span>
<span id="cb14-5"><a href="good-practices.html#cb14-5" tabindex="-1"></a>fs<span class="sc">::</span><span class="fu">file_create</span>(<span class="at">path =</span> <span class="st">&quot;~/AppData/Roaming/RStudio/templates/default.R&quot;</span>)</span>
<span id="cb14-6"><a href="good-practices.html#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="good-practices.html#cb14-7" tabindex="-1"></a><span class="co"># Open the file in RStudio</span></span>
<span id="cb14-8"><a href="good-practices.html#cb14-8" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">edit_file</span>(<span class="st">&quot;~/AppData/Roaming/RStudio/templates/default.R&quot;</span>)</span></code></pre></div>
<p>For example, you can add the following comments to <code>default.R</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="good-practices.html#cb15-1" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb15-2"><a href="good-practices.html#cb15-2" tabindex="-1"></a><span class="do">## Title        :</span></span>
<span id="cb15-3"><a href="good-practices.html#cb15-3" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb15-4"><a href="good-practices.html#cb15-4" tabindex="-1"></a><span class="do">## Description  :</span></span>
<span id="cb15-5"><a href="good-practices.html#cb15-5" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb15-6"><a href="good-practices.html#cb15-6" tabindex="-1"></a><span class="do">## Author       :</span></span>
<span id="cb15-7"><a href="good-practices.html#cb15-7" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb15-8"><a href="good-practices.html#cb15-8" tabindex="-1"></a><span class="do">## Date         :</span></span>
<span id="cb15-9"><a href="good-practices.html#cb15-9" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb15-10"><a href="good-practices.html#cb15-10" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb15-11"><a href="good-practices.html#cb15-11" tabindex="-1"></a><span class="do">## Loading required libraries:########################################</span></span></code></pre></div>
<p>Remember to save the changes you made to <code>default.R</code>.</p>
<p>After the comment section, you should load all required add-on packages using <code>library()</code>. This is more transparent than having many <code>library()</code> calls throughout your entire code. Afterwards, any required files should be sourced using <code>source()</code>. Again, this is more transparent than having many <code>source()</code> calls throughout your entire code. Finally, you can start your code. Within your code, use commented lines of <code>-</code>, <code>=</code> or <code>#</code> to break up your file into smaller bits.</p>
</div>
<div id="styler" class="section level3 hasAnchor" number="2.1.7">
<h3><span class="header-section-number">2.1.7</span> Styler<a href="good-practices.html#styler" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can use the package <a href="https://github.com/r-lib/styler"><code>styler</code></a> to correct your style. It even has RStudio Addins. Once you have installed the package using <code>install.packages("styler")</code>, you can format your code according to the <a href="http://style.tidyverse.org/">tidyverse style guide</a> (or your custom style guide) through the RStudio addin as demonstrated below, or through <code>R</code> functions like <code>style_text()</code>, <code>style_file()</code> or <code>style_pkg()</code>.</p>
<p><img src="https://raw.githubusercontent.com/lorenzwalthert/some_raw_data/master/styler_0.1.gif" width="70%" style="display: block; margin: auto;" /></p>
<p>In RStudio, you can also use the shortcut Ctrl+Shift+A (Windows and Linux) or Shift+Command+A (Mac) to reformat selected code. We will talk about RStudio shortcuts in the next section (<a href="good-practices.html#rstudio">2.2</a>).</p>
</div>
</div>
<div id="rstudio" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> RStudio<a href="good-practices.html#rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Download a recent enough version of the <a href="https://www.rstudio.com/products/rstudio/download/#download">RStudio</a> IDE (see <a href="introduction.html#prerequisites">Prerequisites</a> in Chapter 1 for details). These materials are based on RStudio version 2024.04.2, and we recommend that you use that or any newer version. Once you have installed RStudio, use it!</p>
<p>RStudio comes with many tools and features, for example</p>
<ul>
<li>everything you can expect from a good integrated development environment (IDE)</li>
<li>useful keyboard shortcuts. We often use the following shortcuts (Windows or Linux / Mac)
<ol style="list-style-type: decimal">
<li><em>Ctrl+Space</em> / <em>Command+Space</em> for auto-completion (better than <em>Tab</em>)</li>
<li><em>Ctrl+Up</em> / <em>Command+Up</em> to show and search the command history in a popup</li>
<li><em>Ctrl+Click</em> / <em>Command+Click</em> to see a function’s source code</li>
<li><em>Ctrl+Enter</em> / <em>Command+Return</em> to execute current line/selection of code</li>
<li><em>Ctrl+Shift+A</em> / <em>Shift+Command+A</em> to reformat current selection of code</li>
<li><em>Ctrl+Shift+C</em> / <em>Shift+Command+C</em> to comment/uncomment selected lines</li>
<li><em>Ctrl+Shift+K</em> / <em>Shift+Command+K</em> to knit a document (you will need this in Chapter <a href="rmarkdown.html#rmarkdown">4</a>)</li>
<li><em>Ctrl+Shift+B</em> / <em>Shift+Command+B</em> to build a package, website or book (you will learn how to build a package in Chapter <a href="packages.html#packages">7</a>)</li>
<li><em>Ctrl+Shift+M</em> / <em>Shift+Command+M</em> to insert the pipe operator (we use this shortcut all of the time when working in the <a href="https://www.tidyverse.org/">tidyverse</a>!)</li>
<li><em>Alt+Shift+K</em> / <em>Option+Shift+K</em> to see more keyboard shortcuts.
You can find all keyboard shortcuts by using the keyboard shortcut <em>Alt+Shift+K</em> / <em>Option+Shift+K</em> and click on <em>See All Shortcuts</em> in the upper right corner of the window. You can also find them under the Tools menu <code>Tools -&gt; Keyboard Shortcuts Help -&gt; See All Shortcuts</code>, or you can go to <a href="https://support.posit.co/hc/en-us/articles/200711853-Keyboard-Shortcuts-in-the-RStudio-IDE">this</a> <img src="images/Posit_logo.png" style="display:inline-block; margin:0"/> Support website. Finally, you can also change keyboard shortcuts under the Tools menu <code>Tools -&gt; Modify Keyboard Shortcuts</code>.</li>
</ol></li>
<li>panels (everything is integrated, including Git and a terminal). You can also change the appearance, pane layout, and more under the Tools menu <code>Tools -&gt; Global Options... -&gt; Appearance/Pane Layout</code></li>
</ul>
<p><img src="images/RStudio_appearance_and_pane_layout.jpg" width="70%" style="display: block; margin: auto;" /></p>
<ul>
<li>interactive data importation from files and connections (see <a href="https://www.rstudio.com/resources/webinars/importing-data-into-r/">this webinar</a>):</li>
</ul>
<p><img src="images/data-import-environment.jpg" width="70%" style="display: block; margin: auto;" /></p>
<ul>
<li><p><a href="https://support.posit.co/hc/en-us/articles/205753617-Code-Diagnostics-in-the-RStudio-IDE">code diagnostics</a> can be enabled and options can be set within the <code>Tools -&gt; Global Options -&gt; Code -&gt; Diagnostics</code> editing pane.
<img src="images/code_diagnostics.jpg" width="70%" style="display: block; margin: auto;" />
When code diagnostics are enabled, RStudio performs static and dynamic analysis of your <code>R</code> code and warns you when it detects problems. RStudio reports any errors or warnings in the left gutter (next to the line number) by a marker (<img src="images/error.png" style="display:inline-block; margin:0"/>, <img src="images/info.png" style="display:inline-block; margin:0"/>, <img src="images/warning.png" style="display:inline-block; margin:0"/>) and by underlining the position in the code. When you mouse over the marker, a popup with a short explanation will appear.<br />
<img src="images/code_diagnostics_examples.jpg" width="70%" style="display: block; margin: auto;" /></p></li>
<li><p>Another very useful feature of the RStudio IDE is that it includes <strong>RStudio projects</strong>. RStudio projects make it straightforward to divide your work into multiple contexts, and keep all files associated with a single project together - input data, <code>R</code> scripts, analytic results, figures, etc.
The reason why we advise you to work in RStudio projects is that it doesn’t rely on absolute file paths (in contrast to setting your working directory using <code>setwd()</code>). The chance of <code>setwd()</code> working for anyone besides its author is basically 0 %. And having to hand edit one or more paths every time you take over a project can be extremely annoying. RStudio projects solve this issue by making file paths relative. When your RStudio session is running through an RStudio project file (.Rproj), the current working directory points to the root folder where that .Rproj file is saved. In short, the benefits of using RStudio projects are</p>
<ul>
<li>a meaningful structure in one folder</li>
<li>the working directory automatically switches to the project’s folder</li>
<li>the last previously open file is loaded into the <strong>Source pane</strong></li>
<li>the <strong>History</strong> tab in the <strong>Environment pane</strong> displays <code>R</code> commands executed in previous sessions.</li>
<li>the <strong>Files</strong> tab in the <strong>Output pane</strong> displays the associated files and folders in the project</li>
<li>any settings associated with the project, such as Git settings, are loaded.
Note that you can have a <em>.Rprofile</em> file in the project’s root directory to enable project-specific settings to be loaded each time someone opens the project.</li>
</ul></li>
</ul>
<p>You can read more about RStudio projects in <a href="https://r4ds.had.co.nz/workflow-projects.html">Chapter 8</a> of <a href="https://r4ds.had.co.nz/index.html"><em>R for Data Science</em></a> by Hadley Wickham and Garrett Grolemund, in <a href="https://www.tidyverse.org/articles/2017/12/workflow-vs-script/">this</a> <code>Tidyverse</code> blog post, and also in Section 2.5 <a href="https://bookdown.org/csgillespie/efficientR/set-up.html#rstudio"><em>RStudio</em></a> of <a href="https://bookdown.org/csgillespie/efficientR/"><em>Efficient R programming</em></a> by Colin Gillespie and Robin Lovelace.</p>
</div>
<div id="git" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Version control (Git)<a href="good-practices.html#git" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A useful feature of RStudio projects is that it enables you to use formal version control. Version control is an important process to back up files, keep track of changes, and simplify collaborations. RStudio currently supports two open source version control systems: <a href="https://git-scm.com/downloads">Git</a> and <a href="https://subversion.apache.org/">Subversion</a>. In these materials, we will focus on Git as a version control system, and we will hook our local repositories up to a remote host, namely <a href="https://github.com/">GitHub</a>. You can find more information about how to activate Git on your system in Section <a href="introduction.html#prerequisites">Prerequisites</a> of Chapter 1.</p>
<div id="why-use-git" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Why use Git?<a href="good-practices.html#why-use-git" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Have you ever</p>
<ul>
<li>Made changes to code, realized it was a mistake and wanted to revert back?</li>
<li>Lost code or had a backup that was too old?</li>
<li>Wanted to submit a change to someone’s code?</li>
<li>Wanted to share your code, or let other people work on your code?</li>
</ul>
<p>Or are you a PhD student working on a manuscript?</p>
<p><img src="http://www.datacarpentry.org/rr-version-control/fig/phd101212s.png" width="45%" style="display: block; margin: auto;" /></p>
<p>But you don’t use Git?</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="images/i-also-like-to-live-dangerously.jpg" alt="You don't use Version Control?" width="50%" />
<p class="caption">
Figure 2.1: You don’t use Version Control?
</p>
</div>
In these cases, and probably many others, a version control system should make your life easier (see <a href="https://stackoverflow.com/a/1408464/6103040">this</a> Stack Overflow answer).
With version control you make your workflow reproducible; something that is not only essential in modern day research, but also saves yourself a lot of frustration:
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/s3JldKoA0zw" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</center>
<p>And yes, you should also use version control even if you are mainly working by yourself! See <a href="https://stackoverflow.com/q/2712421/6103040">this</a> Stack Overflow question.
Moreover, version control is very useful when you want to access your projects from different devices and/or places
<img src="images/git.svg" width="70%" style="display: block; margin: auto;" />
Another important aspect is that you need version control to get websites for your packages with <a href="http://pkgdown.r-lib.org/">pkgdown</a>, for your book (like this one!) with <a href="https://bookdown.org/">bookdown</a>, and for your personal webpage with <a href="https://rmarkdown.rstudio.com/rmarkdown_websites.html">R Markdown Websites</a> or <a href="https://bookdown.org/yihui/blogdown/">blogdown</a>.</p>
<p>Finally, being able to work with GitHub can be a line on your CV (<a href="https://github.com/blog/2336-invest-in-tools-students-can-grow-with-github-and-rstudio-for-data-science-at-duke-university">read more</a>):</p>
<blockquote>
<p>A lot of students have said to me later, even first-year undergraduates, that using GitHub has helped them a lot when they went for an internship or a research position interview.</p>
<p>They are able to say, “Oh, I already have worked with GitHub. I am familiar with it. I know how it works.” So I think they are at least able to put that on their CV and go into a situation where there’s a research or data analysis team and say, “Yeah, sure. I am actually familiar with the same tools that you use.”</p>
<footer>
— Mine Cetinkaya-Rundel, Duke University, RStudio
</footer>
</blockquote>
</div>
<div id="how-to-use-git" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> How to use Git<a href="good-practices.html#how-to-use-git" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To share your code and collaborate with other, use a Git hosting platform. A Git hosting platform is basically the Google Docs of collaborative coding. The main platforms are</p>
<ul>
<li><a href="https://github.com/">GitHub</a> (only free for public repositories, now owned by Microsoft)</li>
<li><a href="https://about.gitlab.com/">GitLab</a> (open source &amp; free)</li>
<li><a href="https://bitbucket.org/">Bitbucket</a> (free when you have less than 5 collaborators)</li>
<li>any server.</li>
</ul>
<p>As mentioned before, we will focus on GitHub in these materials.
Once you have created an account on GitHub, the first step is to create a repository. A repository is a folder that contains files, images, sub folders, etc. related to the same project. Hence, it corresponds to an RStudio project. When you are logged into your GitHub account, you can create a new repository by selecting <em>+</em> in the upper-right corner of any page. Select a concise and meaningful name for the repository, and make sure to initialize the repository with a .README file by checking the box. You don’t need to add .gitignore or a license. If you want to, you can also add a short description. Click <em>Create repository</em>.
Once you have created the Git repository, you need to link it to an RStudio project. To link your repository to an RStudio project, you need to generate an SSH key. Click on your avatar in the upper-right corner and go to <em>Settings</em>. In the menu on the left-hand side, select <em>SSH and GPG keys</em>.
Now you need to open an RStudio session. Go to <code>Tools -&gt; Global Options... -&gt; Git/SVN</code>, and select <code>Create SSH Key...</code> When you have created a SSH key, select <code>View public key</code> and copy the key to the clipboard.</p>
<p><img src="images/Create_SSH_key.jpg" width="70%" style="display: block; margin: auto;" /></p>
<p>Return to GitHub, and add the newly created SSH key to your GitHub account by selecting <em>New SSH key</em>, adding a title (indicating the device the key is used for) and inserting the key under <em>Key</em>. Save the key to your GitHub account by clicking <em>Add SSH key</em>. Please note that you only have to generate an SSH key once for each new device that you link to your GitHub account.</p>
<p>Now that you have generated an SSH key, you can link your repository to an RStudio project by following these steps:</p>
<ol style="list-style-type: decimal">
<li>Go to the repository that you want to link (for example by clicking on your avatar in the upper-right corner, and selecting <em>Your repositories</em> in the drop-down menu).</li>
<li>Click the <em>Code</em> tab of your repository.</li>
<li>Above the file list, click the drop-down menu that says <em>&lt;&gt; Code</em>.</li>
<li>Select the tab called <em>Local</em>.</li>
<li>Under the section <em>Clone</em>, select <em>SSH</em> (do not use <em>HTTPS</em> or <em>GitHub CLI</em>).</li>
<li>Copy the URL to the clipboard.</li>
<li>Go back to your RStudio session and create a new project (<code>File -&gt; New Project...</code> or by clicking the icon in the upper-right corner and selecting <code>New Project...</code>).</li>
<li>Create the project from a version control repository.</li>
<li>Select Git to clone a project from a Git repository</li>
<li>Paste the URL from the clipboard under <code>Repository URL:</code> and select the path were you want to save your project.</li>
<li>Enter the passphrase that you selected when you generated the SSH key.</li>
<li>Your GitHub repository will now be cloned (Yeah).</li>
</ol>
<p><img src="images/link_repository_to_rstudio.jpg" width="70%" style="display: block; margin: auto;" /></p>
<p>Instead of following the written steps above, you can also follow the video tutorial below.</p>
<center>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8Q3fYwgyNGQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen>
</iframe>
</center>
<p>A note for Mac users: you might need to use the terminal for <code>git clone</code>, then create the RStudio project from the existing directory. If you have some permission denied for the public key, you might also need to run <code>ssh-agent -s &amp;&amp; ssh-add &lt;path_to_public_key&gt;</code> (cf. <a href="https://stackoverflow.com/a/30806058/6103040">this</a> Stack Overflow answer).</p>
<p>In RStudio, you will probably use the <em>Environment</em> pane to interact with Git. However, you can also use the terminal in the <em>Console</em> pane. In any case, you will need the following Git commands</p>
<ul>
<li><strong>git add [file]</strong>: add a file to your next commit (stage)</li>
<li><strong>git add -A</strong>: add all new or modified files to be part of the next commit</li>
<li><strong>git commit -m “[commit message]”</strong>: snapshot of your code at a specified point in time (you can and you should use this even when having no internet connection)</li>
<li><strong>git push</strong>: merge your local modifications with the main project</li>
<li><strong>git pull</strong>: update your local project with the latest version of the main project</li>
</ul>
<p>In the <em>Environment</em> pane, the command <em>add</em> is equivalent to marking one or more files with a tick (<i class="far fa-square-check" role="presentation" aria-label="square-check icon"></i>) in the Git tab, while the other three are represented by <img src="images/vcsCommit.png" style="display:inline-block; margin:0"/> Commit, <img src="images/vcsPull.png" style="display:inline-block; margin:0"/> Pull, and <img src="images/vcsPush.png" style="display:inline-block; margin:0"/> Push.</p>
<p>When collaborating on a project, you and your co-workers may work on the same file simultaneously. If two people edit the same line of code, Git may not be able to resolve the differences automatically, leading to a merge conflict. When this happens, you have to choose (manually) which changes to incorporate in a new commit. To prevent merge conflicts, we advise you to follow these simple rules:</p>
<ul>
<li>after opening a project, <strong>always pull</strong></li>
<li>before closing a project, <strong>always commit/push</strong></li>
</ul>
<p>Furthermore, you should use git even when you do not have any internet connection (e.g. on a secure server)!</p>
<p>If you have never worked with Git on GitHub (or you need a reminder) we suggest you follow <a href="https://guides.github.com/activities/hello-world/">this</a> tutorial about GitHub essentials. Other helpful websites are</p>
<ul>
<li><a href="http://happygitwithr.com/">Happy Git and GitHub for the useR</a></li>
<li><a href="https://education.github.com/git-cheat-sheet-education.pdf">Git cheat sheet</a></li>
<li><a href="https://github.com/k88hudson/git-flight-rules">When things go wrong</a></li>
<li><a href="http://ohshitgit.com/">To fix a mistake</a></li>
<li><a href="https://github.com/Kunena/Kunena-Forum/wiki/Create-a-new-branch-with-git-and-manage-branches">Create a new branch with git and manage branches</a></li>
</ul>
</div>
<div id="exercise" class="section level3 unnumbered hasAnchor">
<h3>Exercise<a href="good-practices.html#exercise" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong><font size ="4"> Fork a repository </font></strong></p>
<p>Go to <a href="https://github.com/privefl/rmarkdown-website-template">this</a> GitHub repository created by Florian Privé. Fork the repository by opening the drop-down menu named <i class="fa-solid fa-code-fork"></i> <code>Fork</code> in the upper-right corner of the main page of the repository and selecting <code>+ Create a new fork</code>:</p>
<p><img src="images/forkGitHubRepo.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Once you have forked the repository, open the settings (<i class="fa-solid fa-gear"></i> <code>Settings</code>), and change the repository name to [YOURGITHUBNAME].github.io (note that [YOURGITHUBNAME] should be replaced by your GitHub username).</p>
<p>Now follow the steps mentioned above to link your repository to an RStudio project.
<br>
We will work on this RStudio project in Chapter <a href="rmarkdown.html#rmarkdown">4</a>.</p>
<p>You can find GitHub’s documentation on forking a repository <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/working-with-forks/fork-a-repo#forking-a-repository">here</a>.</p>
</div>
</div>
<div id="when-things-go-wrong" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> When things go wrong…<a href="good-practices.html#when-things-go-wrong" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You have spent the last three hours writing the best <code>R</code> function. You press <code>Ctrl+Enter</code> (or <code>Command+Return</code>), and</p>
<pre><code>#&gt; Error in eval(expr, envir, enclos): Something went wrong!</code></pre>
<p><img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExaGZidjU0ejh0MWRpdm1rM2M5c3pkNWk0Y2NsODV3MGsyMTR1b2N4NCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/l1KVaj5UcbHwrBMqI/giphy.gif" /></p>
<p>Don’t give up!</p>
<p>In this section, we will look at some tools that you can use to find and fix problems.</p>
<div id="first-locate-the-error" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> First: locate the error<a href="good-practices.html#first-locate-the-error" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first step is to figure out where the error comes from. In some cases, identifying the line of code that causes the error is easy. In other cases, locating the error can be really difficult. A basic solution is to print everything; but that strategy is usually not working well on complex problems. A more robust strategy is needed!
Start by looking at the error (or warning) message; does it indicate what line or function causes the problem? In the example below, the warning message indicates that <code>log(y)</code> produced <code>NaNs</code>. As <code>log(y)</code> only occurs once, we know that the problem must be in line 3.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb17-1"><a href="good-practices.html#cb17-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">0</span>) {</span>
<span id="cb17-2"><a href="good-practices.html#cb17-2"></a>  y <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb17-3"><a href="good-practices.html#cb17-3"></a>  <span class="fu">invisible</span>(<span class="fu">log</span>(y))</span>
<span id="cb17-4"><a href="good-practices.html#cb17-4"></a>}</span>
<span id="cb17-5"><a href="good-practices.html#cb17-5"></a><span class="co">#&gt; Warning in log(y): NaNs produced</span></span></code></pre></div>
<p>You may be able to fix the bug once you have located it.
In other situations, especially if you are new to <code>R</code>, the error (or warning) message may not help you at all. In that case, you may want to investigate all variables to check whether they have the desired type. A convenient way to see all the variables’ states in your code is to place use the function <code>browser()</code>. <code>browser()</code> stops the execution of the expression in the line it was invoked from. You are able to inspect the environment and evaluate <code>R</code> expressions in that environment by entering them at the browser prompt. from where you want to check the variables’ states. Try running the following code in your own RStudio session.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource r numberLines"><code class="sourceCode r"><span id="cb18-1"><a href="good-practices.html#cb18-1"></a>my_log <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">log</span>(x <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb18-2"><a href="good-practices.html#cb18-2"></a></span>
<span id="cb18-3"><a href="good-practices.html#cb18-3"></a>my_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) {</span>
<span id="cb18-4"><a href="good-practices.html#cb18-4"></a>  <span class="fu">browser</span>()</span>
<span id="cb18-5"><a href="good-practices.html#cb18-5"></a>  la <span class="ot">&lt;-</span> <span class="fu">my_log</span>(a)</span>
<span id="cb18-6"><a href="good-practices.html#cb18-6"></a>  lb <span class="ot">&lt;-</span> <span class="fu">my_log</span>(b)</span>
<span id="cb18-7"><a href="good-practices.html#cb18-7"></a>  la <span class="sc">+</span> lb</span>
<span id="cb18-8"><a href="good-practices.html#cb18-8"></a>}</span>
<span id="cb18-9"><a href="good-practices.html#cb18-9"></a></span>
<span id="cb18-10"><a href="good-practices.html#cb18-10"></a><span class="fu">my_fun</span>(<span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>When you execute line 10, RStudio opens the debug mode. At the top of the console, RStudio now shows a new toolbar that you can use to debug your code:
<img src="images/browser_toolbar.jpg" width="70%" style="display: block; margin: auto;" />
The different buttons execute the following commands:</p>
<ul>
<li><img src="images/debugNext.png" style="display:inline-block; margin:0"/> Next : Execute the next line of code</li>
<li><img src="images/debugStepInto.png" style="display:inline-block; margin:0"/> : Step into the current function call</li>
<li><img src="images/debugRemainder.png" style="display:inline-block; margin:0"/> : Execute the remainder of the current function or loop</li>
<li><img src="images/debugContinue.png" style="display:inline-block; margin:0"/> Continue : Continue execution until the next breakpoint is encountered</li>
<li><img src="images/debugStop.png" style="display:inline-block; margin:0"/> Stop : Exit debug mode</li>
</ul>
<p>Try using the debug mode to locate the error.</p>
<p>One potential problem with <code>browser()</code> is that it is a regular function call; you must add the expression to the code you want to debug. However, sometimes you don’t have the source file for the code you want to debug. When this is the case, you can use the <code>R</code> function <code>debugonce()</code> to flag a function for debugging.
When flagging a function for debugging with <code>debugonce()</code>, the function will enter the debugger the very next time it runs, but not after that (hence the name). Try <code>debugonce()</code> to locate the error in <code>my_fun()</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="good-practices.html#cb19-1" tabindex="-1"></a><span class="fu">debugonce</span>(my_fun)</span>
<span id="cb19-2"><a href="good-practices.html#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="good-practices.html#cb19-3" tabindex="-1"></a><span class="fu">my_fun</span>(<span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>If you want to debug a function every time it is executed, use the function <code>debug()</code> instead. When you no longer want to debug the function each time it executes, use <code>undebug()</code> on the function.</p>
<p>You can read more about debugging in</p>
<ul>
<li><a href="https://support.posit.co/hc/en-us/articles/205612627-Debugging-with-the-RStudio-IDE">this</a> <img src="images/Posit_logo.png" style="display:inline-block; margin:0"/> Support article,</li>
<li><a href="https://adv-r.hadley.nz/debugging.html">Chapter 22</a> of <strong>Advanced R</strong> by Hadley Wickham,</li>
<li><a href="https://bookdown.org/rdpeng/rprogdatascience/debugging.html">Chapter 18</a> of <strong>R Programming for Data Science</strong> by Roger D. Peng, or</li>
<li><a href="https://posit.co/resources/videos/debugging-techniques-in-rstudio/">this</a> <img src="images/Posit_logo.png" style="display:inline-block; margin:0"/> webinar about debugging techniques in RStudio.</li>
</ul>
</div>
<div id="second-fix-the-error" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Second: fix the error<a href="good-practices.html#second-fix-the-error" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once you have located the error, you only have to fix it!</p>
<p><img src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExaXIwY3k3MGV2NDJla2lnMTI1N3ljMmZiOGlsMHZvZjE0bm5mNDlidCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/NaboQwhxK3gMU/giphy.gif" /></p>
<p>Well… Not always…</p>
<p>Fortunately, someone else probably had the same (or a similar) problem before. Try googling the error message to check whether someone already found the answer to your problem. One of the websites that you will see very often when googling errors thrown by or questions related to <code>R</code> is Stack Overflow.</p>
<p><img src="images/meme-SO.jpg" width="25%" style="display: block; margin: auto;" /></p>
<p>If you cannot find your specific problem on Stack Overflow, you can simply create a new question yourself (using the tag <code>r</code>). The only thing you have to keep in mind is that you need to make a good <code>R</code> reproducible example if you want your question to be answered. You can read the answers to <a href="https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example">this</a> Stack Overflow questions about how to make minimal reproducible examples (MREs). In some cases, you actually end up understanding and solving the issue, while making an MRE.</p>
<p>Reading the documentations carefully is also always a really good idea. Many <code>R</code> packages provide reports or long-form guides, called <em>vignettes</em>, that show a workflow solving a specific problem. The <code>tidyverse</code>, for example, has a variety of good vignettes (e.g. <a href="https://dplyr.tidyverse.org/articles/base.html">this</a> article comparing <code>dplyr</code> functions to their base <code>R</code> equivalents). A large number of <code>R</code> packages also have a GitHub repository where you can find additional documentation (see, for example, the GitHub repository for <a href="https://github.com/rfordatascience/tidytuesday"><code>tidytuesday</code></a>).</p>
<p>Finally, you can also search for specific <code>R</code>-related sites on <a href="https://rseek.org/">https://rseek.org/</a>.</p>
</div>
<div id="external-help" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> External help<a href="good-practices.html#external-help" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>You can’t remember all the useful functions provided by a package or how to use a specific function? Use <img src="images/Posit_logo.png" style="display:inline-block; margin:0"/> <a href="https://posit.co/resources/cheatsheets/">Cheatsheets</a>. Cheatsheets usually provide very nice overviews of packages and their functions, and they even come in <a href="https://posit.co/resources/cheatsheets/?type=translations/">different languages</a>.</p></li>
<li><p>If you are confident enough with your R skills, you can take the next step and answer <a href="https://stackoverflow.com/unanswered/tagged/r?tab=newest">questions on Stack Overflow</a>. Answering other people’s questions is a good way to increase your skills - or just to <a href="https://privefl.github.io/blog/one-month-as-a-procrastinator-on-stack-overflow/">procrastinate while writing a scientific manuscript</a>.</p></li>
<li><p>You can also join communities, e.g. the <a href="https://join.slack.com/t/r-grrr/shared_invite/enQtMzI4MzgwNTc4OTAxLWZlOGZiZTBiMWU0NDQ3OTYzOGE1YThiODgwZWNhNWEyYjI4ZDJiNmNhY2YyYWI5YzFiOTFkNDYxYzkwODUwNWM">French-speaking R community</a> on Slack or the <a href="https://rladies-community-slack.herokuapp.com/">R-Ladies community</a> on Slack. These are generally much friendlier and welcoming spaces compared to Stack Overflow.</p></li>
</ul>
</div>
</div>
<div id="summary" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Summary<a href="good-practices.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Use meaningful and concise names for four files, data sets, and functions.</li>
<li>Comment your code and explain <em>why</em> you are doing what you are doing.</li>
<li>Follow the available style guides (e.g. the <a href="https://style.tidyverse.org/">tidyverse style guide</a>). You can use the <code>R</code> package <a href="https://github.com/r-lib/styler"><code>styler</code></a> to conveniently correct your style.</li>
<li>Use the <a href="https://posit.co/download/rstudio-desktop/#download">RStudio</a> IDE; It comes with many tools and features (i.e. useful keyboard shortcuts, panels, interactive data importation from files and connections, code diagnostics, and RStudio projects).</li>
<li>Use formal version control (Git) even if you are mainly working by yourself!</li>
<li>When <code>R</code> throws an error, try to locate it using the error message, <code>browser()</code> or <code>debugonce()</code>.</li>
<li>You can get help to fix an error on Stack Overflow.</li>
</ul>
</div>
<div id="useful-resources-1" class="section level2 unnumbered hasAnchor">
<h2>Useful resources<a href="good-practices.html#useful-resources-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://bookdown.org/content/d1e53ac9-28ce-472f-bc2c-f499f18264a3/#coverpage">Best Coding Practices for R</a> by Grace Hopper</li>
<li><a href="https://nceas.github.io/oss-lessons/version-control/4-getting-started-with-git-in-RStudio.html">Using git from RStudio</a> by Julien Brun</li>
<li><a href="https://docs.posit.co/ide/user/ide/guide/tools/version-control.html">RStudio User Guide - Version Control</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-programming.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
